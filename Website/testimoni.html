<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Testimoni Pelanggan - Makanan Wong Solo">
    <meta name="keywords" content="ulasan, rating, testimoni, review, makanan solo">
    <meta name="author" content="ALWANU ZAKY RAIHAN">
    
    <title>Testimoni - Makanan Wong Solo</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/icons/favicon.ico">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS Utama -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/testimonials.css">
</head>
<body>
    <!-- Batik Background Pattern -->
    <div class="batik-pattern"></div>
    
    <!-- Skip to Content -->
    <a href="#main-content" class="skip-to-content">Skip to Content</a>
    
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>
    
    <!-- WhatsApp Bubble -->
    <div class="wa-bubble">
        <a href="https://api.whatsapp.com/send/?phone=6289513439235&text=Halo%2C+saya+ingin+bertanya+tentang%3A+...&type=phone_number&app_absent=0" 
           target="_blank" 
           class="wa-link"
           aria-label="Hubungi via WhatsApp">
            <div class="wa-icon">
                <i class="fab fa-whatsapp"></i>
            </div>
            <div class="wa-tooltip">
                Tanya via WhatsApp
            </div>
        </a>
    </div>
    
    <!-- Header -->
    <header class="navbar-container">
        <div class="navbar-wrapper">
            <!-- Logo -->
            <div class="logo-section">
                <a href="index.html" class="logo-link">
                    <div class="logo-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="logo-text">
                        <span class="logo-title">Makanan</span>
                        <span class="logo-subtitle">Wong Solo</span>
                    </div>
                </a>
            </div>

            <!-- Desktop Menu -->
            <div class="nav-menu">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Beranda</span>
                </a>
                <a href="produk.html" class="nav-link">
                    <i class="fas fa-utensils"></i>
                    <span>Produk</span>
                </a>
                <a href="pesanan.html" class="nav-link">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Pesanan</span>
                </a>
                <a href="maosan.html" class="nav-link">
                    <i class="fas fa-newspaper"></i>
                    <span>Maosan</span>
                </a>
                <a href="testimoni.html" class="nav-link active">
                    <i class="fas fa-star"></i>
                    <span>Testimoni</span>
                </a>
                <a href="contact.html" class="nav-link">
                    <i class="fas fa-address-book"></i>
                    <span>Contact</span>
                </a>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>

            <!-- Cart Counter -->
            <div class="cart-counter" id="cartCounter">
                <a href="pesanan.html">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="cart-count">0</span>
                </a>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-header">
                <div class="mobile-logo">
                    <i class="fas fa-utensils"></i>
                    <span>Makanan Wong Solo</span>
                </div>
                <button class="mobile-menu-close" id="mobileMenuClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="mobile-nav-links">
                <a href="index.html" class="mobile-nav-link">
                    <i class="fas fa-home"></i>
                    <span>Beranda</span>
                </a>
                <a href="produk.html" class="mobile-nav-link">
                    <i class="fas fa-utensils"></i>
                    <span>Produk</span>
                </a>
                <a href="pesanan.html" class="mobile-nav-link">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Pesanan</span>
                </a>
                <a href="maosan.html" class="mobile-nav-link">
                    <i class="fas fa-newspaper"></i>
                    <span>Maosan</span>
                </a>
                <a href="testimoni.html" class="mobile-nav-link active">
                    <i class="fas fa-star"></i>
                    <span>Testimoni</span>
                </a>
                <a href="contact.html" class="mobile-nav-link">
                    <i class="fas fa-address-book"></i>
                    <span>Contact</span>
                </a>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main id="main-content">
        <!-- Testimonials Hero -->
        <section class="testimonials-hero-section section-padding">
            <div class="container">
                <div class="testimonials-hero-content">
                    <h1 class="testimonials-hero-title">
                        <span class="text-primary">Ulasan & Testimoni</span><br>
                        <span class="text-gold">Pelanggan Kami</span>
                    </h1>
                    <p class="testimonials-hero-description">
                        Dengarkan pengalaman langsung dari pelanggan yang telah merasakan kelezatan makanan tradisional Solo.
                        Setiap testimoni adalah cerita kebahagiaan yang kami hargai.
                    </p>
                    
                    <!-- Stats -->
                    <div class="testimonials-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="totalTestimonials">0</div>
                            <div class="stat-label">Total Testimoni</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="averageRating">0.0</div>
                            <div class="stat-label">Rating Rata-rata</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="fiveStarCount">0</div>
                            <div class="stat-label">Bintang 5</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="featuredReviews">12</div>
                            <div class="stat-label">Review Spesial</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Add Testimonial Section -->
        <section class="add-testimonial-section bg-light section-padding">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Bagikan Pengalaman Anda</h2>
                    <p class="section-subtitle">Ceritakan pengalaman Anda menikmati makanan kami</p>
                </div>
                
                <div class="testimonial-form-container">
                    <form class="testimonial-form" id="testimonialForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reviewerName">
                                    <i class="fas fa-user"></i>
                                    Nama Anda
                                </label>
                                <input type="text" id="reviewerName" placeholder="Masukkan nama lengkap" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="reviewerEmail">
                                    <i class="fas fa-envelope"></i>
                                    Email (Opsional)
                                </label>
                                <input type="email" id="reviewerEmail" placeholder="email@contoh.com">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <i class="fas fa-star"></i>
                                Berikan Rating
                            </label>
                            <div class="rating-input">
                                <div class="stars-container">
                                    <div class="stars" id="ratingStars">
                                        <i class="far fa-star" data-rating="1"></i>
                                        <i class="far fa-star" data-rating="2"></i>
                                        <i class="far fa-star" data-rating="3"></i>
                                        <i class="far fa-star" data-rating="4"></i>
                                        <i class="far fa-star" data-rating="5"></i>
                                    </div>
                                    <div class="rating-text">
                                        <span id="ratingValue">0</span>/5
                                    </div>
                                </div>
                                <input type="hidden" id="ratingInput" name="rating" value="0" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="reviewTitle">
                                <i class="fas fa-heading"></i>
                                Judul Ulasan
                            </label>
                            <input type="text" id="reviewTitle" placeholder="Contoh: Nasi Liwet Terbaik!" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="reviewText">
                                <i class="fas fa-comment"></i>
                                Ulasan Anda
                            </label>
                            <textarea id="reviewText" rows="5" 
                                      placeholder="Ceritakan pengalaman Anda menikmati makanan kami. Apa yang Anda sukai? Bagaimana pelayanannya?" 
                                      required></textarea>
                            <div class="char-counter">
                                <span id="charCount">0</span>/500 karakter
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="productReview">
                                <i class="fas fa-utensils"></i>
                                Produk yang Dipesan (Opsional)
                            </label>
                            <select id="productReview" multiple>
                                <option value="nasi-liwet">Nasi Liwet Solo</option>
                                <option value="selat-solo">Selat Solo</option>
                                <option value="timlo-solo">Timlo Solo</option>
                                <option value="serabi-solo">Serabi Solo</option>
                                <option value="brambang-asem">Brambang Asem</option>
                                <option value="jatah-blondo">Jatah Blondo</option>
                                <option value="cambuk-rambak">Cambuk Rambak</option>
                            </select>
                            <small class="form-hint">Tekan Ctrl/Cmd untuk memilih multiple</small>
                        </div>
                        
                        <div class="form-checkbox">
                            <input type="checkbox" id="agreeTerms" required>
                            <label for="agreeTerms">
                                Saya setuju testimoni ini dipublikasikan di website Makanan Wong Solo
                            </label>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" id="cancelReview">
                                <i class="fas fa-times"></i>
                                Batal
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i>
                                Kirim Testimoni
                            </button>
                        </div>
                    </form>
                    
                    <div class="form-guidelines">
                        <h3><i class="fas fa-info-circle"></i> Pedoman Testimoni</h3>
                        <ul>
                            <li>Berikan ulasan yang jujur dan konstruktif</li>
                            <li>Fokus pada pengalaman pribadi Anda</li>
                            <li>Hindari kata-kata kasar atau tidak pantas</li>
                            <li>Testimoni akan diverifikasi sebelum dipublikasikan</li>
                            <li>Foto profil dihasilkan otomatis berdasarkan nama Anda</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- All Testimonials -->
        <section class="all-testimonials-section section-padding">
            <div class="container">
                <div class="testimonials-header">
                    <div class="header-left">
                        <h2 class="section-title">Semua Testimoni</h2>
                        <p class="section-subtitle">Ulasan dari pelanggan yang telah mencoba kelezatan Solo</p>
                    </div>
                    
                    <div class="header-right">
                        <div class="sort-filter">
                            <select id="sortTestimonials">
                                <option value="newest">Terbaru</option>
                                <option value="oldest">Terlama</option>
                                <option value="highest">Rating Tertinggi</option>
                                <option value="lowest">Rating Terendah</option>
                            </select>
                        </div>
                        
                        <div class="filter-rating">
                            <select id="filterRating">
                                <option value="all">Semua Rating</option>
                                <option value="5">5 Bintang</option>
                                <option value="4">4 Bintang</option>
                                <option value="3">3 Bintang</option>
                                <option value="2">2 Bintang</option>
                                <option value="1">1 Bintang</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Testimonials Container -->
                <div class="testimonials-container" id="testimonialsContainer">
                    <!-- Testimonials will be loaded here -->
                </div>
                
                <!-- Empty State -->
                <div class="empty-state" id="emptyTestimonials">
                    <div class="empty-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h3>Belum Ada Testimoni</h3>
                    <p>Jadilah yang pertama memberikan testimoni untuk Makanan Wong Solo!</p>
                    <button class="btn btn-primary" id="addFirstTestimonial">
                        <i class="fas fa-edit"></i>
                        Tambah Testimoni
                    </button>
                </div>
                
                <!-- Load More -->
                <div class="load-more-container" id="loadMoreTestimonials">
                    <button class="btn btn-outline" id="loadMoreBtn">
                        <i class="fas fa-plus"></i>
                        Muat Lebih Banyak
                    </button>
                </div>
            </div>
        </section>

        <!-- Verified Badge -->
        <section class="verified-section bg-light section-padding">
            <div class="container">
                <div class="verified-content">
                    <div class="verified-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="verified-text">
                        <h3>Testimoni Terverifikasi</h3>
                        <p>Semua testimoni di website ini berasal dari pelanggan nyata yang telah membeli dan menikmati produk kami. Kami tidak menerima testimoni palsu atau berbayar.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="footer-section bg-dark">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-info">
                    <div class="footer-logo">
                        <div class="logo-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div class="logo-text">
                            <span class="logo-title">Makanan</span>
                            <span class="logo-subtitle">Wong Solo</span>
                        </div>
                    </div>
                    <p class="footer-description">
                        Melestarikan cita rasa autentik makanan tradisional Surakarta sejak 1995. 
                        Warisan kuliner keluarga Keraton Surakarta.
                    </p>
                    <div class="footer-social">
                        <a href="https://api.whatsapp.com/send/?phone=6289513439235&text=Halo%2C+saya+ingin+bertanya+tentang%3A+...&type=phone_number&app_absent=0" 
                           target="_blank" class="social-link">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="https://instagram.com/makananwongsolo" target="_blank" class="social-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="mailto:makananwongsolo@gmail.com" class="social-link">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>

                <div class="footer-contact">
                    <h3 class="footer-title">Kontak Kami</h3>
                    <ul class="contact-list">
                        <li>
                            <i class="fas fa-phone"></i>
                            <span>WhatsApp: +62 895-1343-9235</span>
                        </li>
                        <li>
                            <i class="fab fa-instagram"></i>
                            <span>Instagram: @makananwongsolo</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <span>Email: makananwongsolo@gmail.com</span>
                        </li>
                    </ul>
                </div>

                <div class="footer-address">
                    <h3 class="footer-title">Alamat</h3>
                    <div class="address-content">
                        <i class="fas fa-map-marker-alt"></i>
                        <p>Jl. Yos Sudarso, Gawanan,<br>
                           Kec. Colomadu,<br>
                           Kab. Karanganyar,<br>
                           Jawa Tengah 57175</p>
                    </div>
                </div>

                <div class="footer-hours">
                    <h3 class="footer-title">Jam Buka</h3>
                    <ul class="hours-list">
                        <li>
                            <span>Senin - Kamis</span>
                            <span>08:00 - 16:00 WIB</span>
                        </li>
                        <li>
                            <span>Jum'at - Minggu/Hari Libur</span>
                            <span>10:00 - 16:00 WIB</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <div class="copyright">
                    &copy; 2025 Makanan Wong Solo. All rights reserved.
                </div>
                <div class="footer-links">
                    <a href="index.html">Beranda</a>
                    <a href="produk.html">Produk</a>
                    <a href="pesanan.html">Pesanan</a>
                    <a href="maosan.html">Maosan</a>
                    <a href="testimoni.html">Testimoni</a>
                    <a href="contact.html">Contact</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Success Modal -->
    <div class="success-modal" id="successModal">
        <div class="modal-overlay" id="successOverlay"></div>
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3 class="modal-title">Testimoni Terkirim!</h3>
            <p class="modal-message" id="successMessage">
                Terima kasih atas testimoni Anda. Ulasan akan ditampilkan setelah diverifikasi.
            </p>
            <div class="modal-actions">
                <button class="btn btn-primary" id="closeSuccessModal">
                    <i class="fas fa-check"></i>
                    Oke
                </button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript Files -->
    <script src="assets/js/include.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/testimonials.js"></script>
    
    <!-- Inline script untuk testimoni.html -->
    <script>
        // Default testimonials data
        const defaultTestimonials = [
            {
                id: "testimonial-1",
                name: "Budi Santoso",
                email: "",
                title: "Nasi Liwet Autentik!",
                text: "Nasi Liwetnya autentik banget! Rasa kayak zaman kecil dulu. Pelayanannya juga cepat. Sudah pesan 3 kali dan selalu puas.",
                rating: 5,
                date: "2024-03-10",
                products: ["nasi-liwet"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Budi+Santoso&background=B71C1C&color=fff&size=128"
            },
            {
                id: "testimonial-2",
                name: "Sari Dewi",
                email: "sari.dewi@email.com",
                title: "Serabi Lembut dan Enak",
                text: "Serabi Solonya lembut dan enak. Keluarga saya suka semua, terutama anak-anak. Pengiriman tepat waktu! Akan pesan lagi minggu depan.",
                rating: 4,
                date: "2024-03-08",
                products: ["serabi-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Sari+Dewi&background=D4AF37&color=000&size=128"
            },
            {
                id: "testimonial-3",
                name: "Agus Prasetyo",
                email: "agus.prasetyo@email.com",
                title: "Selat Solo Juara!",
                text: "Selat Solonya juara! Dagingnya empuk, sausnya khas banget. Recommended buat yang suka makanan fusion Jawa-Eropa.",
                rating: 5,
                date: "2024-03-05",
                products: ["selat-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Agus+Prasetyo&background=5D4037&color=fff&size=128"
            },
            {
                id: "testimonial-4",
                name: "Rina Wijaya",
                email: "rina.w@email.com",
                title: "Timlo Enak untuk Keluarga",
                text: "Timlo Solo enak banget, kuahnya gurih. Anak-anak suka karena ada soun dan telur puyuhnya. Pesan 2 porsi cukup untuk 4 orang.",
                rating: 4,
                date: "2024-03-03",
                products: ["timlo-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Rina+Wijaya&background=2196F3&color=fff&size=128"
            },
            {
                id: "testimonial-5",
                name: "Hendra Setiawan",
                email: "",
                title: "Jajanan Tradisional Mantap",
                text: "Brambang Asem dan Jatah Blondo enak banget. Cocok buat camilan nonton TV. Rasa khas Solo banget, gurih dan manis pas.",
                rating: 5,
                date: "2024-02-28",
                products: ["brambang-asem", "jatah-blondo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Hendra+Setiawan&background=4CAF50&color=fff&size=128"
            },
            {
                id: "testimonial-6",
                name: "Dewi Lestari",
                email: "dewi.l@email.com",
                title: "Layanan Ramah dan Cepat",
                text: "Selain makanannya enak, pelayanannya juga ramah. CS responsif via WhatsApp. Pengiriman cepat meskipun lokasi agak jauh.",
                rating: 5,
                date: "2024-02-25",
                products: ["nasi-liwet", "serabi-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Dewi+Lestari&background=9C27B0&color=fff&size=128"
            },
            {
                id: "testimonial-7",
                name: "Bambang Sugiarto",
                email: "",
                title: "Rasa seperti di Solo",
                text: "Saya asli Solo yang merantau. Rasa Nasi Liwet dan Serabi di sini persis seperti di kampung halaman. Bikin kangen terobati.",
                rating: 5,
                date: "2024-02-20",
                products: ["nasi-liwet", "serabi-solo", "timlo-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Bambang+Sugiarto&background=FF9800&color=000&size=128"
            },
            {
                id: "testimonial-8",
                name: "Citra Ayu",
                email: "citra.ayu@email.com",
                title: "Cocok untuk Acara Keluarga",
                text: "Pesan untuk acara keluarga, semua suka. Kemasan rapi, makanan tetap hangat saat sampai. Akan jadi langganan untuk acara keluarga.",
                rating: 4,
                date: "2024-02-18",
                products: ["nasi-liwet", "selat-solo", "cambuk-rambak"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Citra+Ayu&background=F44336&color=fff&size=128"
            },
            {
                id: "testimonial-9",
                name: "Ahmad Fauzi",
                email: "",
                title: "Harga Terjangkau, Rasa Premium",
                text: "Untuk kualitas dan rasa seperti ini, harganya sangat terjangkau. Sudah coba semua menu utama, semua enak tanpa terkecuali.",
                rating: 5,
                date: "2024-02-15",
                products: ["nasi-liwet", "selat-solo", "timlo-solo"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Ahmad+Fauzi&background=607D8B&color=fff&size=128"
            },
            {
                id: "testimonial-10",
                name: "Maya Sari",
                email: "maya.sari@email.com",
                title: "Cambuk Rambak Unik dan Enak",
                text: "Pertama kali coba Cambuk Rambak, ternyata enak banget. Kerupuknya renyah, sambal kacangnya pas. Unik dan recommended!",
                rating: 4,
                date: "2024-02-12",
                products: ["cambuk-rambak"],
                verified: true,
                avatar: "https://ui-avatars.com/api/?name=Maya+Sari&background=795548&color=fff&size=128"
            }
        ];

        // Testimonials state
        let testimonials = [];
        let filteredTestimonials = [];
        let currentRating = 0;
        let displayLimit = 6;

        // Initialize testimonials page
        document.addEventListener('DOMContentLoaded', function() {
            // Load testimonials
            loadTestimonials();
            
            // Setup rating stars
            setupRatingStars();
            
            // Setup character counter
            setupCharCounter();
            
            // Setup form submission
            setupTestimonialForm();
            
            // Setup sort and filter
            setupSortAndFilter();
            
            // Setup load more
            setupLoadMore();
            
            // Setup success modal
            setupSuccessModal();
            
            // Update cart counter
            updateCartCounter();
        });

        // Load testimonials from localStorage
        function loadTestimonials() {
            try {
                const storedTestimonials = localStorage.getItem('makananWongSoloTestimonials');
                
                if (storedTestimonials) {
                    testimonials = JSON.parse(storedTestimonials);
                } else {
                    // Save default testimonials
                    testimonials = [...defaultTestimonials];
                    saveTestimonials();
                }
                
                // Update stats
                updateStats();
                
                // Filter and display
                filterAndDisplayTestimonials();
                
            } catch (error) {
                console.error('Error loading testimonials:', error);
                testimonials = [...defaultTestimonials];
                filterAndDisplayTestimonials();
            }
        }

        // Save testimonials to localStorage
        function saveTestimonials() {
            try {
                localStorage.setItem('makananWongSoloTestimonials', JSON.stringify(testimonials));
                return true;
            } catch (error) {
                console.error('Error saving testimonials:', error);
                return false;
            }
        }

        // Update statistics
        function updateStats() {
            // Calculate statistics
            const total = testimonials.length;
            const average = testimonials.length > 0 
                ? (testimonials.reduce((sum, t) => sum + t.rating, 0) / testimonials.length).toFixed(1)
                : "0.0";
            const fiveStar = testimonials.filter(t => t.rating === 5).length;
            
            // Update DOM
            document.getElementById('totalTestimonials').textContent = total;
            document.getElementById('averageRating').textContent = average;
            document.getElementById('fiveStarCount').textContent = fiveStar;
        }

        // Filter and display testimonials
        function filterAndDisplayTestimonials() {
            const sortValue = document.getElementById('sortTestimonials').value;
            const filterValue = document.getElementById('filterRating').value;
            
            // Filter by rating
            filteredTestimonials = [...testimonials];
            
            if (filterValue !== 'all') {
                const rating = parseInt(filterValue);
                filteredTestimonials = filteredTestimonials.filter(t => t.rating === rating);
            }
            
            // Sort
            switch(sortValue) {
                case 'newest':
                    filteredTestimonials.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'oldest':
                    filteredTestimonials.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'highest':
                    filteredTestimonials.sort((a, b) => b.rating - a.rating);
                    break;
                case 'lowest':
                    filteredTestimonials.sort((a, b) => a.rating - b.rating);
                    break;
            }
            
            // Display
            displayTestimonials(filteredTestimonials.slice(0, displayLimit));
            
            // Show/hide load more button
            const loadMoreContainer = document.getElementById('loadMoreTestimonials');
            if (loadMoreContainer) {
                loadMoreContainer.style.display = filteredTestimonials.length > displayLimit ? 'flex' : 'none';
            }
            
            // Show/hide empty state
            const emptyState = document.getElementById('emptyTestimonials');
            if (emptyState) {
                emptyState.style.display = filteredTestimonials.length === 0 ? 'flex' : 'none';
            }
        }

        // Display testimonials in container
        function displayTestimonials(testimonialsToShow) {
            const container = document.getElementById('testimonialsContainer');
            if (!container) return;
            
            container.innerHTML = testimonialsToShow.map(testimonial => `
                <div class="testimonial-card" data-rating="${testimonial.rating}">
                    <div class="testimonial-header">
                        <div class="reviewer-avatar">
                            <img src="${testimonial.avatar}" alt="${testimonial.name}" loading="lazy">
                            ${testimonial.verified ? `
                            <div class="verified-badge" title="Testimoni Terverifikasi">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            ` : ''}
                        </div>
                        <div class="reviewer-info">
                            <h4 class="reviewer-name">${testimonial.name}</h4>
                            <div class="review-date">${formatDate(testimonial.date)}</div>
                        </div>
                        <div class="review-rating">
                            ${generateStars(testimonial.rating)}
                        </div>
                    </div>
                    
                    <div class="testimonial-body">
                        <h5 class="review-title">${testimonial.title}</h5>
                        <p class="review-text">${testimonial.text}</p>
                        
                        ${testimonial.products && testimonial.products.length > 0 ? `
                        <div class="review-products">
                            <span class="products-label">Produk yang dipesan:</span>
                            <div class="product-tags">
                                ${testimonial.products.map(product => `
                                    <span class="product-tag">${getProductName(product)}</span>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="testimonial-footer">
                        <div class="review-helpful">
                            <button class="helpful-btn" data-id="${testimonial.id}">
                                <i class="far fa-thumbs-up"></i>
                                <span class="helpful-count">${testimonial.helpful || 0}</span>
                            </button>
                        </div>
                        <div class="review-actions">
                            <button class="action-btn share-review" data-id="${testimonial.id}">
                                <i class="fas fa-share-alt"></i>
                            </button>
                            <button class="action-btn report-review" data-id="${testimonial.id}">
                                <i class="far fa-flag"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners
            document.querySelectorAll('.helpful-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const testimonialId = this.dataset.id;
                    markHelpful(testimonialId);
                });
            });
            
            document.querySelectorAll('.share-review').forEach(button => {
                button.addEventListener('click', function() {
                    const testimonialId = this.dataset.id;
                    shareTestimonial(testimonialId);
                });
            });
        }

        // Setup rating stars
        function setupRatingStars() {
            const stars = document.querySelectorAll('#ratingStars i');
            const ratingValue = document.getElementById('ratingValue');
            const ratingInput = document.getElementById('ratingInput');
            
            stars.forEach(star => {
                star.addEventListener('mouseover', function() {
                    const rating = parseInt(this.dataset.rating);
                    highlightStars(rating);
                });
                
                star.addEventListener('click', function() {
                    const rating = parseInt(this.dataset.rating);
                    currentRating = rating;
                    ratingValue.textContent = rating;
                    ratingInput.value = rating;
                    highlightStars(rating);
                });
            });
            
            // Reset stars when mouse leaves container
            document.getElementById('ratingStars').addEventListener('mouseleave', function() {
                highlightStars(currentRating);
            });
        }

        // Highlight stars up to given rating
        function highlightStars(rating) {
            const stars = document.querySelectorAll('#ratingStars i');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.className = 'fas fa-star';
                    star.style.color = 'var(--secondary-gold)';
                } else {
                    star.className = 'far fa-star';
                    star.style.color = 'var(--gray-medium)';
                }
            });
        }

        // Setup character counter
        function setupCharCounter() {
            const textarea = document.getElementById('reviewText');
            const charCount = document.getElementById('charCount');
            
            if (textarea && charCount) {
                textarea.addEventListener('input', function() {
                    const count = this.value.length;
                    charCount.textContent = count;
                    
                    if (count > 500) {
                        charCount.style.color = 'var(--primary-red)';
                        this.style.borderColor = 'var(--primary-red)';
                    } else {
                        charCount.style.color = 'var(--text-light)';
                        this.style.borderColor = 'var(--gray-light)';
                    }
                });
            }
        }

        // Setup testimonial form
        function setupTestimonialForm() {
            const form = document.getElementById('testimonialForm');
            const cancelBtn = document.getElementById('cancelReview');
            const addFirstBtn = document.getElementById('addFirstTestimonial');
            
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    submitTestimonial();
                });
            }
            
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function() {
                    resetForm();
                });
            }
            
            if (addFirstBtn) {
                addFirstBtn.addEventListener('click', function() {
                    document.querySelector('.add-testimonial-section').scrollIntoView({ 
                        behavior: 'smooth' 
                    });
                });
            }
        }

        // Submit new testimonial
        function submitTestimonial() {
            const name = document.getElementById('reviewerName').value.trim();
            const email = document.getElementById('reviewerEmail').value.trim();
            const rating = parseInt(document.getElementById('ratingInput').value);
            const title = document.getElementById('reviewTitle').value.trim();
            const text = document.getElementById('reviewText').value.trim();
            
            // Validation
            if (!name || !rating || !title || !text) {
                showNotification('Harap isi semua field yang wajib diisi', 'error');
                return;
            }
            
            if (text.length > 500) {
                showNotification('Ulasan maksimal 500 karakter', 'error');
                return;
            }
            
            if (rating < 1 || rating > 5) {
                showNotification('Harap berikan rating', 'error');
                return;
            }
            
            // Get selected products
            const productSelect = document.getElementById('productReview');
            const selectedProducts = Array.from(productSelect.selectedOptions).map(option => option.value);
            
            // Create new testimonial
            const newTestimonial = {
                id: `testimonial-${Date.now()}`,
                name: name,
                email: email,
                title: title,
                text: text,
                rating: rating,
                date: new Date().toISOString().split('T')[0],
                products: selectedProducts,
                verified: false,
                helpful: 0,
                avatar: `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=${getRandomColor()}&color=fff&size=128`
            };
            
            // Add to testimonials
            testimonials.unshift(newTestimonial);
            saveTestimonials();
            
            // Update display
            updateStats();
            filterAndDisplayTestimonials();
            
            // Reset form
            resetForm();
            
            // Show success message
            showSuccessModal('Terima kasih atas testimoni Anda! Ulasan akan ditampilkan setelah diverifikasi.');
            
            // Show notification
            showNotification('Testimoni berhasil dikirim!', 'success');
        }

        // Reset form
        function resetForm() {
            document.getElementById('testimonialForm').reset();
            document.getElementById('ratingInput').value = '0';
            document.getElementById('ratingValue').textContent = '0';
            document.getElementById('charCount').textContent = '0';
            currentRating = 0;
            highlightStars(0);
        }

        // Setup sort and filter
        function setupSortAndFilter() {
            const sortSelect = document.getElementById('sortTestimonials');
            const filterSelect = document.getElementById('filterRating');
            
            if (sortSelect) {
                sortSelect.addEventListener('change', filterAndDisplayTestimonials);
            }
            
            if (filterSelect) {
                filterSelect.addEventListener('change', filterAndDisplayTestimonials);
            }
        }

        // Setup load more
        function setupLoadMore() {
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', function() {
                    displayLimit += 6;
                    filterAndDisplayTestimonials();
                });
            }
        }

        // Setup success modal
        function setupSuccessModal() {
            const overlay = document.getElementById('successOverlay');
            const closeBtn = document.getElementById('closeSuccessModal');
            const modal = document.getElementById('successModal');
            
            if (overlay) {
                overlay.addEventListener('click', closeSuccessModal);
            }
            
            if (closeBtn) {
                closeBtn.addEventListener('click', closeSuccessModal);
            }
        }

        // Show success modal
        function showSuccessModal(message) {
            const modal = document.getElementById('successModal');
            const messageElem = document.getElementById('successMessage');
            
            if (modal && messageElem) {
                messageElem.textContent = message;
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        // Close success modal
        function closeSuccessModal() {
            const modal = document.getElementById('successModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // Mark testimonial as helpful
        function markHelpful(testimonialId) {
            const testimonial = testimonials.find(t => t.id === testimonialId);
            if (testimonial) {
                testimonial.helpful = (testimonial.helpful || 0) + 1;
                saveTestimonials();
                
                // Update button
                const button = document.querySelector(`.helpful-btn[data-id="${testimonialId}"]`);
                if (button) {
                    const countSpan = button.querySelector('.helpful-count');
                    if (countSpan) {
                        countSpan.textContent = testimonial.helpful;
                    }
                    button.innerHTML = `<i class="fas fa-thumbs-up"></i><span class="helpful-count">${testimonial.helpful}</span>`;
                    button.style.color = 'var(--primary-red)';
                }
                
                showNotification('Terima kasih atas masukan Anda!', 'success');
            }
        }

        // Share testimonial
        function shareTestimonial(testimonialId) {
            const testimonial = testimonials.find(t => t.id === testimonialId);
            if (!testimonial) return;
            
            const text = `${testimonial.name} memberi rating ${testimonial.rating}/5 untuk Makanan Wong Solo: "${testimonial.title}"`;
            const url = window.location.href;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Testimoni Makanan Wong Solo',
                    text: text,
                    url: url
                });
            } else {
                // Fallback for browsers that don't support Web Share API
                const shareUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(text + ' ' + url)}`;
                window.open(shareUrl, '_blank');
            }
        }

        // Helper functions
        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<i class="fas fa-star"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            return stars;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
        }

        function getProductName(productId) {
            const products = {
                'nasi-liwet': 'Nasi Liwet Solo',
                'selat-solo': 'Selat Solo',
                'timlo-solo': 'Timlo Solo',
                'serabi-solo': 'Serabi Solo',
                'brambang-asem': 'Brambang Asem',
                'jatah-blondo': 'Jatah Blondo',
                'cambuk-rambak': 'Cambuk Rambak'
            };
            return products[productId] || productId;
        }

        function getRandomColor() {
            const colors = ['B71C1C', 'D4AF37', '5D4037', '4CAF50', '2196F3', '9C27B0', 'FF9800', '795548'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function showNotification(message, type = 'info') {
            if (window.MakananWongSolo && window.MakananWongSolo.showNotification) {
                window.MakananWongSolo.showNotification(message, type);
            } else {
                alert(message);
            }
        }

        function updateCartCounter() {
            const cartCounter = document.getElementById('cartCounter');
            if (cartCounter) {
                try {
                    const cart = JSON.parse(localStorage.getItem('makananWongSoloCart')) || [];
                    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                    const countElement = cartCounter.querySelector('.cart-count');
                    if (countElement) {
                        countElement.textContent = totalItems;
                        countElement.style.display = totalItems > 0 ? 'flex' : 'none';
                    }
                } catch (error) {
                    console.error('Error updating cart counter:', error);
                }
            }
        }
    </script>
</body>
</html>
